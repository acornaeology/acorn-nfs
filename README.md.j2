# {{ name }}

[![Verify disassembly]({{ repo_url }}/actions/workflows/verify.yml/badge.svg)]({{ repo_url }}/actions/workflows/verify.yml)

{{ description }}

This repository contains annotated disassemblies of the Acorn NFS ROM, produced by reverse-engineering the original 6502 machine code. Each disassembly includes named labels, comments explaining the logic, and cross-references between subroutines.

## Versions
{% for version in versions %}
- **{{ version.title }}**
  - [Formatted disassembly on acornaeology.uk]({{ version.site_url }})
  - [Raw assembly source]({{ version.asm_path }})
{%- for link in version.links %}
  - [{{ link.label }}]({{ link.url }})
{%- endfor %}
{%- for doc in version.docs %}
  - [{{ doc.label }}]({{ doc.path }})
{%- endfor %}
{%- endfor %}

## How it works

The disassembly is produced by a Python script that drives a custom version of [py8dis](https://github.com/acornaeology/py8dis), a programmable disassembler for 6502 binaries. The script feeds the original ROM image to py8dis along with annotations — entry points, labels, constants, and comments — to produce readable assembly output.

The output is verified by reassembling with [beebasm](https://github.com/stardot/beebasm) and comparing the result byte-for-byte against the original ROM. This round-trip verification runs automatically in CI on every push.

## Building locally

Requires [uv](https://docs.astral.sh/uv/) and [beebasm](https://github.com/stardot/beebasm).

```sh
uv sync
{% for version in versions -%}
uv run acorn-nfs-disasm-tool disassemble {{ version.id }}
uv run acorn-nfs-disasm-tool verify {{ version.id }}
{% endfor -%}
```
{% if references %}
## References
{% for ref in references %}
- [{{ ref.label }}]({{ ref.url }})
{%- if ref.note %}
  {{ ref.note }}
{%- endif %}
{%- endfor %}
{%- endif %}

## Credits

- [py8dis](https://github.com/acornaeology/py8dis) by [SteveF](https://github.com/ZornsLemma), forked for use with acornaeology
- [beebasm](https://github.com/stardot/beebasm) by Rich Mayfield and contributors
- [The BBC Micro ROM Library](https://tobylobster.github.io/rom_library/) by tobylobster

## License

The annotations and disassembly scripts in this repository are released under the [MIT License](LICENSE). The original ROM images remain the property of their respective copyright holders.
